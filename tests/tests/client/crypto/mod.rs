use client::crypto::dec_xor_pass;

#[test]
fn it_decodes() {
    let mut buffer: [u8; 184] = [
        0, 0, 0, 0, 0, 107, 145, 2, 4, 186, 95, 2, 4, 78, 228, 47, 6, 156, 76, 238, 127, 142, 2,
        138, 205, 214, 230, 160, 93, 86, 254, 44, 118, 176, 75, 6, 4, 136, 239, 171, 91, 136, 49,
        242, 181, 10, 184, 179, 251, 152, 69, 32, 110, 25, 189, 159, 5, 2, 207, 232, 87, 1, 64, 4,
        190, 60, 17, 137, 96, 99, 115, 238, 164, 163, 152, 92, 140, 218, 181, 31, 169, 184, 160,
        20, 182, 93, 88, 222, 170, 164, 141, 231, 94, 54, 164, 227, 200, 94, 152, 154, 100, 96,
        136, 4, 229, 215, 125, 121, 74, 41, 18, 9, 10, 201, 15, 90, 39, 227, 232, 206, 134, 96,
        216, 82, 189, 47, 136, 35, 242, 102, 252, 212, 224, 182, 144, 162, 142, 170, 151, 211, 235,
        170, 151, 211, 235, 170, 151, 211, 235, 170, 151, 211, 235, 234, 233, 221, 21, 36, 105,
        169, 216, 234, 228, 3, 196, 229, 147, 236, 230, 204, 84, 82, 187, 204, 84, 82, 187, 204,
        84, 82, 187, 204, 84, 82,
    ];
    let key: u32 = 1381289147;
    let expected: [u8; 184] = [
        0, 0, 0, 0, 4, 33, 198, 0, 0, 124, 4, 233, 250, 197, 87, 242, 237, 233, 77, 152, 202, 220,
        24, 234, 14, 99, 111, 124, 207, 249, 58, 41, 114, 200, 231, 97, 179, 255, 33, 166, 246,
        141, 121, 126, 140, 98, 251, 147, 97, 126, 25, 78, 107, 27, 242, 120, 168, 252, 240, 20,
        213, 253, 174, 124, 94, 224, 157, 28, 196, 195, 251, 189, 216, 9, 236, 165, 43, 189, 42,
        19, 199, 237, 24, 197, 44, 6, 210, 7, 152, 174, 17, 7, 22, 23, 204, 137, 212, 190, 31, 153,
        63, 86, 210, 131, 223, 240, 147, 127, 188, 17, 18, 51, 47, 234, 151, 144, 89, 124, 63, 3,
        221, 122, 160, 78, 243, 138, 171, 143, 210, 232, 108, 182, 102, 28, 7, 113, 101, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 49, 63, 133, 189, 126, 77, 170, 28, 72, 105, 144,
        154, 41, 199, 190, 93, 0, 0, 0, 0, 0, 0, 0, 187, 204, 84, 82, 187, 204, 84, 82,
    ];

    dec_xor_pass(&mut buffer, 0, 184, key).unwrap();
    assert_eq!(buffer, expected);
}

#[test]
fn it_returns_err_on_size_less_than_12() {
    let mut buffer: [u8; 5] = [0, 0, 0, 0, 0];
    let key: u32 = 1381289147;
    dec_xor_pass(&mut buffer, 0, 5, key).unwrap_err();
}
